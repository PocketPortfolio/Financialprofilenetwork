<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pocket Portfolio â€” Invest smarter, together</title>
  <meta name="description" content="Pocket Portfolio is an open-source, community-led investing dashboard with live prices, profit/loss, mock trades, news, and simple trade import. Invest smarter, together." />
  <meta name="theme-color" content="#0b1220" />
  <meta name="color-scheme" content="dark light" />

  <!-- Canonical / OG / Twitter -->
  <link rel="canonical" href="https://pocketportfolio.app/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Pocket Portfolio" />
  <meta property="og:title" content="Pocket Portfolio â€” Invest smarter, together" />
  <meta property="og:description" content="Open-source, community-led investing dashboard with live P/L, mock trades, prices, and insights." />
  <meta property="og:url" content="https://pocketportfolio.app/" />
  <meta property="og:image" content="/brand/og-base.svg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Pocket Portfolio â€” Invest smarter, together" />
  <meta name="twitter:description" content="Open-source, community-led investing dashboard with live P/L, mock trades, prices, and insights." />
  <meta name="twitter:image" content="/brand/og-base.svg" />

  <!-- Favicons / PWA -->
  <link rel="manifest" href="/app/manifest.webmanifest">
  <link rel="icon" href="/brand/pp-monogram.svg">
  <link rel="apple-touch-icon" href="/brand/pp-monogram.svg">

  <!-- Perf -->
  <link rel="prefetch" href="/app/" as="document" />

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            pp: {
              bg: "#0b1220",
              blue: "#2563eb",
              green: "#10b981",
              red: "#ef4444",
              slate: "#94a3b8",
              glow1:"#0ea5e9",
              glow2:"#34d399"
            }
          },
          boxShadow: {
            'soft': '0 8px 40px rgba(0,0,0,.35)',
            'brand': '0 0 120px 40px rgba(14,165,233,.20)'
          }
        }
      }
    }
  </script>

  <!-- THEME TOKENS (landing uses the same model as app) -->
<style>
  /* Base (dark) */
  :root{
    --bg:#0b1220; --chrome:#0b1220; --text:#ffffff; --muted:#94a3b8;
    --card:rgba(255,255,255,.06); --card-border:rgba(255,255,255,.08);
    --brand:#2563eb; --pos:#10b981; --neg:#ef4444; --base-fs:100%;

    /* tokens used when a visually dark surface exists inside light mode */
    --text-inverse:#ffffff;
    --muted-inverse:#cbd5e1;
    --card-on-dark:rgba(255,255,255,.06);
    --card-border-on-dark:rgba(255,255,255,.12);
  }

  /* LIGHT â€” high contrast & clear separation */
  [data-theme="light"]{
    --bg:#f6f8fb;            /* soft paper */
    --chrome:#ffffff;
    --text:#0b1220;          /* very dark ink */
    --muted:#334155;         /* readable muted */
    --card:#ffffff;          /* real cards on paper */
    --card-border:#d6dee6;   /* clear edges */
    --brand:#2563eb; --pos:#0aa06f; --neg:#e11d2e;
  }

  /* HIGH CONTRAST (unchanged) */
  [data-theme="contrast"]{
    --bg:#000; --chrome:#000; --text:#fff; --muted:#fff;
    --card:#000; --card-border:#fff; --brand:#ffd000; --pos:#00ff6a; --neg:#ff3b30;
  }

  /* System light follows improved light */
  @media (prefers-color-scheme: light){
    :root:not([data-theme]){
      --bg:#f6f8fb; --chrome:#ffffff; --text:#0b1220; --muted:#334155;
      --card:#ffffff; --card-border:#d6dee6;
    }
  }

  /* Global mappings so Tailwind classes stay consistent across themes */
  html{ font-size:var(--base-fs); }
  body{ background:var(--bg); color:var(--text); }
  a{ color:var(--brand); }
  .glass{ background:var(--card); border:1px solid var(--card-border); }
  .shadow-soft{ box-shadow:0 4px 24px rgba(0,0,0,.25); }
  .bg-pp-bg{ background-color:var(--bg)!important; }
  .text-pp-slate{ color:var(--muted)!important; }
  .border-white\/10{ border-color:var(--card-border)!important; }
  .hover\:bg-white\/5:hover{
    background-color: color-mix(in srgb, var(--text) 5%, transparent)!important;
  }
  :focus-visible{ outline:2px solid var(--brand); outline-offset:2px; }
  @media (prefers-reduced-motion: reduce){ *{ animation:none!important; transition:none!important; } }

  /* ----------------- Surface: dark-on-light utility ------------------ */
  /* Apply to sections that are visually dark (hero, sticky header over hero) */
  .on-dark{
    color:var(--text-inverse);
    --text:  var(--text-inverse);
    --muted: var(--muted-inverse);
    --card:  var(--card-on-dark);
    --card-border: var(--card-border-on-dark);
  }
  .on-dark a{ color:#9dc1ff; }
</style>


  <!-- Structured data -->
  <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"Organization","name":"Pocket Portfolio","url":"https://pocketportfolio.app/","logo":"https://pocketportfolio.app/icon-192.png","sameAs":["https://github.com/hakeem22s/Financialprofilenetwork","https://discord.com/channels/1412824844265066538/1412824845120438443"]}
  </script>
  <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"SoftwareApplication","name":"Pocket Portfolio","operatingSystem":"Web","applicationCategory":"FinanceApplication","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"url":"https://pocketportfolio.app/app/"}
  </script>
</head>
<body class="antialiased">
  <a href="#mission" class="sr-only focus:not-sr-only focus:outline-none focus:ring-2 focus:ring-pp-blue px-3 py-2 absolute left-2 top-2 rounded">Skip to content</a>

  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur bg-pp-bg/70 border-b border-white/10 on-dark">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <!-- Brand -->
      <a href="/" class="flex items-center gap-2" aria-label="Pocket Portfolio â€” Home">
        <picture>
          <source srcset="/brand/pp-monogram.svg" type="image/svg+xml" />
          <img src="/icon-192.png" alt="Pocket Portfolio" class="w-8 h-8 rounded-md" width="32" height="32" fetchpriority="high" />
        </picture>
        <img src="/brand/pp-wordmark.svg" alt="Pocket Portfolio" class="h-5 hidden sm:block" width="156" height="20" loading="eager" decoding="async" />
      </a>

      <nav class="hidden md:flex items-center gap-6 text-sm text-pp-slate" aria-label="Primary navigation">
        <a href="#mission" class="hover:text-white">Mission</a>
        <a href="#features" class="hover:text-white">Features</a>
        <a href="#pillars" class="hover:text-white">FIN Pillars</a>
        <a href="#community" class="hover:text-white">Community</a>
        <a href="#faq" class="hover:text-white">FAQ</a>
      </nav>

      <!-- Actions -->
      <div class="hidden md:flex items-center gap-2">
        <a href="/app/" class="px-3 py-2 rounded-md border border-white/20 text-sm hover:bg-white/5">Launch App</a>
        <a href="#waitlist" class="px-4 py-2 rounded-md bg-pp-blue hover:bg-pp-blue/90 text-sm font-medium">Join Waitlist</a>

        <!-- Theme & text-size -->
        <label for="themeSel" class="sr-only">Theme</label>
        <select id="themeSel" class="px-2 py-2 rounded-md border border-white/20 bg-white/5 text-sm" title="Theme">
          <option value="system">System</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="contrast">High contrast</option>
        </select>
        <div class="flex gap-1" aria-label="Text size">
          <button type="button" id="fsMinus" class="px-2 py-2 rounded-md border border-white/20 text-sm">Aâˆ’</button>
          <button type="button" id="fsPlus"  class="px-2 py-2 rounded-md border border-white/20 text-sm">A+</button>
        </div>
      </div>

      <!-- Mobile menu button -->
      <button id="menuBtn" class="md:hidden p-2 rounded-md border border-white/10" aria-expanded="false" aria-controls="mobileNav" aria-label="Open menu">â˜°</button>
    </div>

    <!-- Mobile menu -->
    <div id="mobileNav" class="md:hidden hidden border-t border-white/10" role="region" aria-label="Mobile navigation">
      <nav class="px-4 py-3 flex flex-col gap-2 text-pp-slate">
        <a href="#mission" class="hover:text-white">Mission</a>
        <a href="#features" class="hover:text-white">Features</a>
        <a href="#pillars" class="hover:text-white">FIN Pillars</a>
        <a href="#community" class="hover:text-white">Community</a>
        <a href="#faq" class="hover:text-white">FAQ</a>
        <a href="/app/" class="mt-2 px-3 py-2 rounded-md border border-white/20 text-sm hover:bg-white/5 text-white">Launch App</a>
        <a href="#waitlist" class="px-3 py-2 rounded-md bg-pp-blue hover:bg-pp-blue/90 text-sm text-white text-center">Join Waitlist</a>
        <!-- Accessibility controls (mobile) -->
<div class="mt-4 grid gap-2">
  <label for="themeSelMobile" class="text-sm text-pp-slate">Theme</label>
  <select id="themeSelMobile"
          class="px-3 py-2 rounded-md border border-white/20 bg-white/5 text-white">
    <option value="system">System</option>
    <option value="light">Light</option>
    <option value="dark">Dark</option>
    <option value="contrast">High contrast</option>
  </select>

  <div class="flex gap-2 items-center" aria-label="Text size">
    <button type="button" id="fsMinusM"
            class="flex-1 px-3 py-2 rounded-md border border-white/20">Aâˆ’</button>
    <button type="button" id="fsPlusM"
            class="flex-1 px-3 py-2 rounded-md border border-white/20">A+</button>
  </div>
</div>

      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative overflow-hidden on-dark">
    <img src="/brand/hero-glow.svg" alt="" aria-hidden="true" class="absolute inset-0 w-full h-full object-cover pointer-events-none select-none opacity-90" />
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-10 lg:pb-16 relative">
      <div class="grid lg:grid-cols-2 gap-10 items-center">
        <div>
          <h1 class="text-4xl sm:text-5xl font-extrabold leading-tight tracking-tight">Invest smarter, <span class="text-pp-green">together</span>.</h1>
          <p class="mt-5 text-lg text-pp-slate max-w-2xl">
            Pocket Portfolio is a community-led, open-source investing dashboard.
            Live profit/loss, real-time prices, human-friendly insightsâ€”built in public with the people it serves.
          </p>
          <div class="mt-6 flex flex-wrap gap-3">
            <a href="/app/" class="px-5 py-3 rounded-lg bg-pp-blue hover:bg-pp-blue/90 font-medium shadow-soft">Launch App</a>
            <a href="#waitlist" class="px-5 py-3 rounded-lg border border-white/20 hover:bg-white/5 font-medium">Join Waitlist</a>
            <a target="_blank" rel="noopener" href="https://github.com/hakeem22s/Financialprofilenetwork" class="px-5 py-3 rounded-lg glass font-medium">Star on GitHub</a>
          </div>
          <div class="mt-6 text-pp-slate text-sm flex items-center gap-4">
            <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-pp-green inline-block"></span> Open source</div>
            <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-pp-blue inline-block"></span> Community-led</div>
            <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-white/70 inline-block"></span> Privacy-first</div>
          </div>
        </div>
        <div class="relative">
          <div class="absolute -inset-6 bg-gradient-to-tr from-blue-600/20 to-green-500/10 rounded-3xl blur-2xl"></div>
          <img src="/brand/preview-dashboard.svg" alt="Pocket Portfolio dashboard preview" class="relative rounded-2xl border border-white/10 shadow-soft" fetchpriority="high" />
        </div>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section id="features" class="py-16 border-t border-white/10">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-3xl font-bold tracking-tight">What you get today</h2>
      <div class="mt-8 grid grid-auto-fit gap-6">
        <div class="glass rounded-xl p-6">
          <img src="/brand/ico-live-pl.svg" alt="" class="w-8 h-8 mb-3" loading="lazy" />
          <h3 class="font-semibold">Live Profit / Loss</h3>
          <p class="text-pp-slate mt-2">Unrealised P/L at a glance, refreshed with live prices every 30s.</p>
        </div>
        <div class="glass rounded-xl p-6">
          <img src="/brand/ico-prices.svg" alt="" class="w-8 h-8 mb-3" loading="lazy" />
          <h3 class="font-semibold">Real-time Prices</h3>
          <p class="text-pp-slate mt-2">Equities, FX, and crypto with resilient multi-source fallbacks.</p>
        </div>
        <!-- New: Mock Trades -->


        <div class="glass rounded-xl p-6">
          <img src="/brand/ico-news.svg" alt="" class="w-8 h-8 mb-3" loading="lazy" />
          <h3 class="font-semibold">Smart News</h3>
          <p class="text-pp-slate mt-2">Ticker-aware news with images, interleaved so every position is represented.</p>
        </div>
<div class="glass rounded-xl p-6">
  <!-- inline icon: dashed circle + plus -->
  <svg class="w-8 h-8 mb-3 text-white/90" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
    <circle cx="12" cy="12" r="9" stroke-dasharray="3 3"></circle>
    <path d="M12 8v8M8 12h8"></path>
  </svg>
  <h3 class="font-semibold">Mock Trades</h3>
  <p class="text-pp-slate mt-2">
    Paper-invest without committing capital. Test ideas, learn safely, and keep
    mock positions separate from realised P/L.
  </p>
</div>

        <div class="glass rounded-xl p-6">
          <h3 class="font-semibold">CSV Import</h3>
          <p class="text-pp-slate mt-2">Broker-agnostic parsing. Add historical trades fast.</p>
        </div>
        <div class="glass rounded-xl p-6">
          <h3 class="font-semibold">Per-asset Breakdown</h3>
          <p class="text-pp-slate mt-2">Multi-series portfolio timeline and pie allocation (mock trades excluded).</p>
        </div>
        <div class="glass rounded-xl p-6">
          <h3 class="font-semibold">Privacy-first</h3>
          <p class="text-pp-slate mt-2">Own your data. Export any time. Open roadmap and open source.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Mission -->
  <section id="mission" class="py-16 border-t border-white/10">
    <div class="max-w-5xl mx-auto px-4">
      <h2 class="text-3xl font-bold tracking-tight">Our Mission</h2>
      <p class="mt-4 text-pp-slate leading-relaxed">
        Pocket Portfolio exists to help people make better investment decisions, together.
        We are building a community-led, open-source platform that turns market noise into clear, actionable insightâ€”so anyone can learn, evaluate, and act with confidence.
      </p>
    </div>
  </section>

  <!-- Pillars -->
  <section id="pillars" class="py-16">
    <div class="max-w-7xl mx-auto px-4">
      <h3 class="text-xl font-semibold text-pp-slate mb-2">The FIN Pillars</h3>
      <h2 class="text-3xl font-bold tracking-tight mb-8">Future â€¢ Investment â€¢ Now</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="glass rounded-xl p-6">
          <h3 class="text-xl font-bold">Future</h3>
          <p class="mt-3 text-pp-slate">We design in the open and evolve with our community. We challenge the status quo in investment education and accessibility, and we focus relentlessly on clarity of insight.</p>
          <ul class="mt-4 text-pp-slate space-y-1 list-disc list-inside">
            <li>Open-source core</li><li>Capability building with the community</li><li>Insight-first design</li>
          </ul>
        </div>
        <div class="glass rounded-xl p-6">
          <h3 class="text-xl font-bold">Investment</h3>
          <p class="mt-3 text-pp-slate">We promote investment mindsets through thoughtful design, technical excellence, and ambidextrous methodsâ€”tools that are simple to use and powerful under the hood.</p>
          <ul class="mt-4 text-pp-slate space-y-1 list-disc list-inside">
            <li>Human-centered UX</li><li>Robust data engineering</li><li>Evidence-based decisions</li>
          </ul>
        </div>
        <div class="glass rounded-xl p-6">
          <h3 class="text-xl font-bold">Now</h3>
          <p class="mt-3 text-pp-slate">We stay present and adaptable to evolving markets. Community comes firstâ€”we learn out loud and ship improvements quickly with honesty and transparency.</p>
          <ul class="mt-4 text-pp-slate space-y-1 list-disc list-inside">
            <li>Real-time insights</li><li>Fast, iterative delivery</li><li>Transparent roadmap</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Community -->
  <section id="community" class="py-16">
    <div class="max-w-7xl mx-auto px-4">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <h2 class="text-3xl font-bold tracking-tight">Built with community</h2>
          <p class="mt-4 text-pp-slate">Pocket Portfolio is open source. Contribute features, fix bugs, propose ideas, or help with docs. We keep the roadmap transparent and welcome first-time contributors.</p>
          <ul class="mt-6 text-pp-slate space-y-2">
            <li>â€¢ Public roadmap &amp; issues</li>
            <li>â€¢ Good-first-issue labels</li>
            <li>â€¢ Code of Conduct &amp; governance</li>
          </ul>
          <div class="mt-6 flex gap-3">
            <a target="_blank" rel="noopener" href="https://github.com/hakeem22s/Financialprofilenetwork" class="px-4 py-2 rounded-lg glass">GitHub</a>
            <a target="_blank" rel="noopener" href="https://discord.com/channels/1412824844265066538/1412824845120438443" class="px-4 py-2 rounded-lg border border-white/20 hover:bg-white/5">Join Discord</a>
          </div>
        </div>
        <div class="relative">
          <div class="absolute -inset-6 bg-gradient-to-tr from-green-600/20 to-blue-500/10 rounded-3xl blur-2xl"></div>
          <img src="/brand/preview-live.svg" alt="Live prices & P/L preview" class="relative rounded-2xl border border-white/10 shadow-soft" />
        </div>
      </div>
    </div>
  </section>

  <!-- Waitlist -->
  <section id="waitlist" class="py-16 border-t border-white/10">
    <div class="max-w-2xl mx-auto px-4 text-center">
      <h2 class="text-3xl font-bold tracking-tight">Be first to know what ships next</h2>
      <p class="mt-3 text-pp-slate">Join the waitlist and get release notes, contributor calls, and early features.</p>

      <form id="waitlistForm" class="mt-6 flex flex-col sm:flex-row gap-3 justify-center">
        <input type="text" name="website" autocomplete="off" tabindex="-1" class="hidden" />
        <input required type="email" name="email" placeholder="you@example.com"
               class="w-full sm:w-80 px-4 py-3 rounded-lg bg-white/5 border border-white/10 placeholder:text-pp-slate focus:outline-none focus:ring-2 focus:ring-pp-blue" />
        <button class="px-5 py-3 rounded-lg bg-pp-blue hover:bg-pp-blue/90 font-medium">Join Waitlist</button>
      </form>
      <p id="waitlistThanks" class="hidden mt-3 text-pp-green">Thanksâ€”check your inbox! ðŸŽ‰</p>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="py-16">
    <div class="max-w-5xl mx-auto px-4">
      <h2 class="text-3xl font-bold tracking-tight">FAQ</h2>
      <div class="mt-6 space-y-6">
        <details class="glass rounded-lg p-4">
          <summary class="font-medium">Is Pocket Portfolio free?</summary>
          <p class="mt-2 text-pp-slate">Yes. Itâ€™s open source. If the community later wants premium data sources, weâ€™ll decide together.</p>
        </details>
        <details class="glass rounded-lg p-4">
          <summary class="font-medium">How do you handle my data?</summary>
          <p class="mt-2 text-pp-slate">You control your data. We store the minimum needed and make export easy. See our privacy note in the repository.</p>
        </details>
        <details class="glass rounded-lg p-4">
          <summary class="font-medium">Can I contribute?</summary>
          <p class="mt-2 text-pp-slate">Please! Check the GitHub repo for issues, roadmap, and contribution guidelines.</p>
        </details>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-10 border-t border-white/10">
    <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row items-center justify-between gap-4 text-pp-slate">
      <p>&copy; <span id="y"></span> Pocket Portfolio â€” Built with the community.</p>
      <div class="flex items-center gap-4">
        <a href="https://github.com/hakeem22s/Financialprofilenetwork" target="_blank" rel="noopener" class="hover:text-white">GitHub</a>
        <a href="https://discord.com/channels/1412824844265066538/1412824845120438443" target="_blank" rel="noopener" class="hover:text-white">Discord</a>
        <a href="/app/" class="hover:text-white">Launch App</a>
      </div>
    </div>
  </footer>

  <!-- UI small bits -->
  <script>
    const menuBtn = document.getElementById('menuBtn');
    const mobileNav = document.getElementById('mobileNav');
    menuBtn?.addEventListener('click', () => {
      const open = mobileNav.classList.toggle('hidden') === false;
      menuBtn.setAttribute('aria-expanded', String(open));
      menuBtn.setAttribute('aria-label', open ? 'Close menu' : 'Open menu');
    });
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>

  <!-- Firebase (compat) for waitlist -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const firebaseConfig = {
        apiKey: "AIzaSyDIL02q3thafHYAEziJVRlr4ibst5dqvRo",
        authDomain: "pocket-portfolio-67fa6.firebaseapp.com",
        projectId: "pocket-portfolio-67fa6",
      };
      if (!firebase.apps?.length) firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      const form  = document.getElementById('waitlistForm');
      const okMsg = document.getElementById('waitlistThanks');

      form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const fd = new FormData(form);
        if ((fd.get('website') || '').toString()) return; // honeypot
        const email = (fd.get('email') || '').toString().trim().toLowerCase();
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { alert('Please enter a valid email'); return; }

        try {
          await db.collection('waitlist').add({
            email,
            source: 'landing',
            page: location.pathname + location.hash,
            ua: navigator.userAgent.slice(0, 200),
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });
          form.reset();
          okMsg?.classList.remove('hidden');
        } catch (err) {
          console.error('waitlist error', err);
          alert('Sorry, something went wrong. Please try again.');
        }
      });
    });
  </script>

  <!-- THEME + TEXT SIZE CONTROLLER (shared logic) -->
<script>
(function(){
  const THEME_KEY = 'pp-theme';
  const FS_KEY = 'pp-fs';
  const meta = document.querySelector('meta[name="theme-color"]');
  const prefersDark = matchMedia('(prefers-color-scheme: dark)');

  const themeSelects = [
    document.getElementById('themeSel'),
    document.getElementById('themeSelMobile')
  ].filter(Boolean);

  function systemTheme(){ return prefersDark.matches ? 'dark' : 'light'; }

  function applyTheme(mode){
    const t = mode === 'system' ? systemTheme() : mode;
    document.documentElement.setAttribute('data-theme', t);
    if (meta) {
      const chrome = getComputedStyle(document.documentElement)
        .getPropertyValue('--chrome').trim() || (t==='light' ? '#ffffff' : '#0b1220');
      meta.content = chrome;
    }
    localStorage.setItem(THEME_KEY, mode);
    // keep both selects in sync
    themeSelects.forEach(sel => { if (sel) sel.value = mode; });
  }

  // init theme
  const savedTheme = localStorage.getItem(THEME_KEY) || 'system';
  applyTheme(savedTheme);
  themeSelects.forEach(sel => sel.addEventListener('change', e => applyTheme(e.target.value)));
  prefersDark.addEventListener?.('change', () => {
    if ((localStorage.getItem(THEME_KEY) || 'system') === 'system') applyTheme('system');
  });

  // font size 90â€“130%
  function setFs(delta){
    const cur = Number(localStorage.getItem(FS_KEY) || '100');
    const next = Math.min(130, Math.max(90, cur + delta));
    document.documentElement.style.setProperty('--base-fs', next + '%');
    localStorage.setItem(FS_KEY, String(next));
  }
  const fsPlusIds = ['fsPlus','fsPlusM'], fsMinusIds = ['fsMinus','fsMinusM'];
  fsPlusIds.forEach(id => document.getElementById(id)?.addEventListener('click', () => setFs(10)));
  fsMinusIds.forEach(id => document.getElementById(id)?.addEventListener('click', () => setFs(-10)));

  const savedFs = localStorage.getItem(FS_KEY);
  if (savedFs) document.documentElement.style.setProperty('--base-fs', savedFs + '%');
})();
</script>

</body>
</html>
