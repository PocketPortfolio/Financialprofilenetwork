"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[226],{2226:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(7437),i=r(2265),s=r(4379);function a(e){let{onImport:t}=e,[r,a]=(0,i.useState)(!1),[o,l]=(0,i.useState)(!1),d=e=>{let t=[],r="",n=!1;for(let i=0;i<e.length;i++){let s=e[i];'"'===s?n=!n:","!==s||n?r+=s:(t.push(r.trim()),r="")}return t.push(r.trim()),t},c=e=>{let t=e.trim().split("\n"),r=[];if(t.length<2)return r.push("CSV must have at least a header row and one data row"),{valid:!1,errors:r};let n=d(t[0].toLowerCase()),i=n.some(e=>e.includes("date")||e.includes("timestamp")||e.includes("opentime")||e.includes("time")),s=n.some(e=>"ticker"===e||e.includes("symbol")||e.includes("asset")),a=n.some(e=>e.includes("type")||e.includes("action")||e.includes("side")),o=n.some(e=>e.includes("quantity")||e.includes("units")||e.includes("amount")||e.includes("transacted")),l=n.some(e=>"spot price at transaction"===e||e.includes("price")||e.includes("rate")||e.includes("openrate")||e.includes("share")),c=[];return(i||c.push("date/timestamp"),s||c.push("ticker/symbol"),a||c.push("type/action/side"),o||c.push("quantity/units"),l||c.push("price/rate"),c.length>0)?(r.push("Missing required columns: ".concat(c.join(", "))),r.push("Found columns: ".concat(n.slice(0,10).join(", ")).concat(n.length>10?"...":"")),{valid:!1,errors:r}):{valid:!0,errors:[]}},u=e=>{let t=e.trim().split("\n"),r=d(t[0].toLowerCase()),n=[],i=r.findIndex(e=>e.includes("date")||e.includes("timestamp")||e.includes("opentime")||e.includes("time")),s=-1;s=r.includes("ticker")?r.findIndex(e=>"ticker"===e):r.includes("symbol")?r.findIndex(e=>"symbol"===e):r.findIndex(e=>e.includes("ticker")||e.includes("symbol")||e.includes("asset")||e.includes("instrument"));let a=r.findIndex(e=>e.includes("action")||e.includes("type")||e.includes("side")||e.includes("transaction type")),o=-1;for(let e of["no. of shares","shares","quantity","units","quantity transacted","transacted","amount"]){let t=r.findIndex(t=>t.toLowerCase().includes(e.toLowerCase()));if(-1!==t){o=t;break}}let l=-1;for(let e of["price / share","share price","price","rate","openrate","spot price","open rate"]){let t=r.findIndex(t=>t.toLowerCase().includes(e.toLowerCase()));if(-1!==t){l=t;break}}let c=-1===o?r.findIndex(e=>e.includes("shares")||e.includes("quantity")||e.includes("units")):o,u=-1===l?r.findIndex(e=>e.includes("price")||e.includes("rate")):l,p="Unknown";r.includes("units")&&r.includes("openrate")?p="eToro":r.includes("quantity transacted")&&r.includes("spot price at transaction")?p="Coinbase":r.includes("action")&&(r.includes("ticker")||r.includes("isin"))?p="Trading212":r.includes("t.price")&&r.includes("proceeds")?p="InteractiveBrokers":r.includes("stock")&&r.includes("total")?p="Freetrade":r.includes("side")&&r.includes("amount")?p="Webull":r.includes("quantity")&&r.includes("price")?p="Generic":r.includes("no. of shares")&&r.includes("price / share")&&(p="Trading212");let h=r.findIndex(e=>e.includes("currency")||e.includes("spot price currency"));for(let e=1;e<t.length;e++){let o=d(t[e]);if(!(o.length<r.length))try{var m,f,g,y,v,x,k;let e=(null===(m=o[s])||void 0===m?void 0:m.trim().toUpperCase())||"";if(!e||e.length>10||e.includes(" "))for(let t=0;t<o.length;t++){let r=(null===(x=o[t])||void 0===x?void 0:x.trim().toUpperCase())||"";if(r&&r.length<=10&&!r.includes(" ")&&!["BUY","SELL","USD","EUR","GBP"].includes(r)&&/^[A-Z0-9]+$/.test(r)){e=r;break}}if(e.includes(" ")&&e.length>10){let t=e.split(" ");t.slice(1,-1).join(" ").trim(),e=t[t.length-1].trim()}let t=(null===(f=o[a])||void 0===f?void 0:f.trim().toUpperCase())||"",r=parseFloat((null===(g=o[c])||void 0===g?void 0:g.trim())||"0"),l=parseFloat((null===(y=o[u])||void 0===y?void 0:y.trim().replace(/[$,\s]/g,"").replace(/X\d+$/,""))||"0"),d=h>=0&&(null===(v=o[h])||void 0===v?void 0:v.trim().toUpperCase())||"USD";if(!e||t.includes("CASH")||t.includes("WITHDRAWAL")||t.includes("DIVIDEND"))continue;let p=t.toUpperCase(),b=p.includes("BUY")||p.includes("MARKET BUY")||p.includes("LIMIT BUY"),C=p.includes("SELL")||p.includes("MARKET SELL")||p.includes("LIMIT SELL");if(b||C){let t={id:"csv-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),date:(null===(k=o[i])||void 0===k?void 0:k.trim())||new Date().toISOString().split("T")[0],ticker:e,type:b?"BUY":"SELL",currency:d,qty:r,price:l,mock:!1};t.ticker&&t.qty>0&&t.price>0&&n.push(t)}}catch(e){}}return{trades:n,broker:p}},p=async e=>{if((0,s.FK)({source:"dashboard_upload"}),!e.name.toLowerCase().endsWith(".csv")){alert("Please select a valid CSV file."),(0,s.cy)({errorType:"invalid_file_type",errorMessage:"File is not a CSV"});return}l(!0);try{let r=await e.text(),n=c(r);if(!n.valid){(0,s.cy)({errorType:"validation_failed",errorMessage:n.errors.join("; ")}),alert("Invalid CSV format:\n\n".concat(n.errors.join("\n"),"\n\nPlease ensure your CSV has the required columns:\n• Date/Timestamp\n• Ticker/Symbol\n• Type/Action\n• Quantity/Units\n• Price/Rate")),l(!1);return}let{trades:i,broker:a}=u(r);if(0===i.length){(0,s.cy)({errorType:"no_trades_found",errorMessage:"No valid trades found in CSV",broker:a}),alert("No valid trades found in the CSV file. Please check that:\n• Your CSV contains BUY or SELL transactions\n• Quantity and price values are valid numbers\n• The file format matches the supported formats"),l(!1);return}t(i),(0,s.Qk)({broker:a,rowCount:i.length,fileSize:e.size}),alert("✓ Successfully imported ".concat(i.length," trade").concat(1===i.length?"":"s"," from ").concat(e.name))}catch(e){(0,s.cy)({errorType:"parse_error",errorMessage:e instanceof Error?e.message:"Unknown error"}),alert("Error processing CSV file. Please check the format and try again.\n\nError: "+(e instanceof Error?e.message:"Unknown error"))}finally{l(!1)}},h=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?a(!0):"dragleave"===e.type&&a(!1)};return(0,n.jsxs)("div",{onDragEnter:h,onDragLeave:h,onDragOver:h,onDrop:e=>{e.preventDefault(),e.stopPropagation(),a(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&p(e.dataTransfer.files[0])},style:{border:"2px dashed ".concat(r?"var(--brand)":"var(--card-border)"),borderRadius:"12px",padding:"32px",textAlign:"center",background:r?"var(--chrome)":"var(--card)",transition:"all 0.2s ease",cursor:"pointer"},children:[(0,n.jsx)("input",{type:"file",accept:".csv",onChange:e=>{e.target.files&&e.target.files[0]&&p(e.target.files[0])},style:{display:"none"},id:"csv-upload",disabled:o}),(0,n.jsx)("label",{htmlFor:"csv-upload",style:{cursor:o?"not-allowed":"pointer"},children:o?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"skeleton-loader",style:{height:"40px",borderRadius:"8px",marginBottom:"16px"}}),(0,n.jsx)("p",{style:{color:"var(--muted)",fontSize:"16px"},children:"Processing CSV file..."})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{width:"48px",height:"48px",background:"var(--brand)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",color:"white",fontSize:"24px"},children:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M14 2V8H20",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M12 18L12 12",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M9 15L12 12L15 15",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,n.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px",color:"var(--text)"},children:"Drop CSV file here or click to browse"}),(0,n.jsx)("p",{style:{color:"var(--muted)",fontSize:"14px",marginBottom:"16px"},children:"Supports multiple CSV formats: Trading212, eToro, Coinbase, OpenBrokerCSV, and more"}),(0,n.jsxs)("div",{style:{background:"var(--bg)",border:"1px solid var(--card-border)",borderRadius:"8px",padding:"16px",fontSize:"12px",color:"var(--muted)",textAlign:"left"},children:[(0,n.jsx)("strong",{children:"Supported formats:"}),(0,n.jsx)("br",{}),"• Trading212: Action, Time, Ticker, No. of shares, Price / share...",(0,n.jsx)("br",{}),"• eToro: PositionID, OrderID, Action, Ticker, Units, OpenRate...",(0,n.jsx)("br",{}),"• Coinbase: Timestamp, Transaction Type, Asset, Quantity, Spot Price...",(0,n.jsx)("br",{}),"• OpenBrokerCSV: Date, Ticker, Type, Currency, Quantity, Price",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Required columns:"})," Date, Ticker/Symbol, Type/Action, Quantity/Units, Price/Rate"]})]})})]})}}}]);