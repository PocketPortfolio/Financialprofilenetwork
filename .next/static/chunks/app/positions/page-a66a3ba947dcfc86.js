(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[266],{9266:function(e,r,t){Promise.resolve().then(t.bind(t,603))},603:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return u}});var i=t(7437),n=t(2265),o=t(1586),s=t(4330),a=t(8483),l=t(5687),d=t(2530),c=t(7429);function u(){let{isAuthenticated:e,user:r,signInWithGoogle:t,logout:u}=(0,s.a)(),{trades:p,deleteTrade:x}=(0,o.K)(),g=n.useMemo(()=>Object.values(p.filter(e=>!e.mock).reduce((e,r)=>{let{ticker:t,qty:i,price:n,type:o,date:s}=r;if(e[t]||(e[t]={ticker:t,shares:0,avgCost:0,currentPrice:0,currentValue:0,unrealizedPL:0,unrealizedPLPercent:0,totalTrades:0,lastTradeDate:s,isMock:!1,currency:r.currency||"USD"}),"BUY"===o){let r=e[t].shares*e[t].avgCost+i*n;e[t].shares+=i,e[t].avgCost=r/e[t].shares}else e[t].shares-=i;return e[t].totalTrades+=1,e[t].lastTradeDate=s,e},{})).filter(e=>e.shares>0),[p]),h=g.map(e=>e.ticker),{data:f}=(0,c.vR)(h),m=n.useMemo(()=>g.map(e=>{let r=null==f?void 0:f[e.ticker];return r&&r.price&&("GBp"===r.currency?(e.currentPrice=r.price/100,e.currency="GBP"):(e.currentPrice=r.price,e.currency=r.currency),e.currentValue=e.shares*e.currentPrice,e.unrealizedPL=e.currentValue-e.shares*e.avgCost,e.unrealizedPLPercent=e.avgCost>0?e.unrealizedPL/(e.shares*e.avgCost)*100:0),e}),[g,f]),y=async e=>{try{await x(e)}catch(e){e instanceof Error&&(e.message.includes("permissions")||e.message.includes("Missing or insufficient permissions"))?alert("Unable to delete this trade. It may have been created before sign-in. Try deleting from localStorage or re-importing your data."):alert("Failed to delete trade. Please try again.")}};return e?(0,i.jsxs)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"var(--bg)",color:"var(--text)"},children:[(0,i.jsx)(a.Z,{title:"Positions - Pocket Portfolio",description:"View your portfolio positions and holdings"}),(0,i.jsx)(l.Z,{title:"Positions"}),(0,i.jsxs)("main",{style:{flex:1,padding:"20px",maxWidth:"1200px",margin:"0 auto",width:"100%"},children:[(0,i.jsx)("div",{style:{marginBottom:"32px"},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},children:[(0,i.jsx)("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"linear-gradient(135deg, var(--accent-warm) 0%, #f59e0b 100%)",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"16px"},children:(0,i.jsx)("span",{style:{fontSize:"24px"},children:"\uD83D\uDCCA"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:"32px",fontWeight:"700",margin:"0 0 4px 0",color:"var(--text)"},children:"Portfolio Positions"}),(0,i.jsx)("p",{style:{color:"var(--muted)",fontSize:"16px",margin:0},children:"Track your investment performance and holdings"})]})]})}),0===m.length?(0,i.jsxs)("div",{style:{background:"var(--surface)",border:"1px solid var(--border)",borderRadius:"12px",padding:"40px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDCCA"}),(0,i.jsx)("h3",{style:{fontSize:"20px",marginBottom:"8px"},children:"No positions found"}),(0,i.jsx)("p",{style:{color:"var(--muted)",marginBottom:"24px"},children:"Start by adding some trades to see your positions here"}),(0,i.jsx)("a",{href:"/dashboard",style:{background:"linear-gradient(135deg, var(--accent-warm) 0%, #f59e0b 100%)",color:"white",textDecoration:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",display:"inline-block"},children:"Go to Dashboard"})]}):(0,i.jsx)(d.Z,{trades:p,positions:m,onDeleteTrade:y,onViewTrades:e=>{}})]})]}):(0,i.jsxs)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",background:"var(--bg)",color:"var(--text)"},children:[(0,i.jsx)(a.Z,{title:"Positions - Pocket Portfolio",description:"View your portfolio positions and holdings"}),(0,i.jsx)(l.Z,{title:"Positions"}),(0,i.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("h1",{style:{fontSize:"24px",marginBottom:"16px"},children:"Sign in to view positions"}),(0,i.jsx)("p",{style:{color:"var(--muted)",marginBottom:"24px"},children:"Access your portfolio positions and holdings"}),(0,i.jsx)("button",{onClick:t,style:{background:"linear-gradient(135deg, var(--accent-warm) 0%, #f59e0b 100%)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:"Sign in with Google"})]})})]})}}},function(e){e.O(0,[358,139,726,244,958,687,586,626,971,117,744],function(){return e(e.s=9266)}),_N_E=e.O()}]);