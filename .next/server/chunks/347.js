"use strict";exports.id=347,exports.ids=[347],exports.modules={37347:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(10326),i=t(17577),s=t(52780);function a({onImport:e}){let[r,t]=(0,i.useState)(!1),[a,o]=(0,i.useState)(!1),l=e=>{let r=[],t="",n=!1;for(let i=0;i<e.length;i++){let s=e[i];'"'===s?n=!n:","!==s||n?t+=s:(r.push(t.trim()),t="")}return r.push(t.trim()),r},d=e=>{let r=e.trim().split("\n"),t=[];if(r.length<2)return t.push("CSV must have at least a header row and one data row"),{valid:!1,errors:t};let n=l(r[0].toLowerCase()),i=n.some(e=>e.includes("date")||e.includes("timestamp")||e.includes("opentime")||e.includes("time")),s=n.some(e=>"ticker"===e||e.includes("symbol")||e.includes("asset")),a=n.some(e=>e.includes("type")||e.includes("action")||e.includes("side")),o=n.some(e=>e.includes("quantity")||e.includes("units")||e.includes("amount")||e.includes("transacted")),d=n.some(e=>"spot price at transaction"===e||e.includes("price")||e.includes("rate")||e.includes("openrate")||e.includes("share")),c=[];return(i||c.push("date/timestamp"),s||c.push("ticker/symbol"),a||c.push("type/action/side"),o||c.push("quantity/units"),d||c.push("price/rate"),c.length>0)?(t.push(`Missing required columns: ${c.join(", ")}`),t.push(`Found columns: ${n.slice(0,10).join(", ")}${n.length>10?"...":""}`),{valid:!1,errors:t}):{valid:!0,errors:[]}},c=e=>{let r=e.trim().split("\n"),t=l(r[0].toLowerCase()),n=[],i=t.findIndex(e=>e.includes("date")||e.includes("timestamp")||e.includes("opentime")||e.includes("time")),s=-1;s=t.includes("ticker")?t.findIndex(e=>"ticker"===e):t.includes("symbol")?t.findIndex(e=>"symbol"===e):t.findIndex(e=>e.includes("ticker")||e.includes("symbol")||e.includes("asset")||e.includes("instrument"));let a=t.findIndex(e=>e.includes("action")||e.includes("type")||e.includes("side")||e.includes("transaction type")),o=-1;for(let e of["no. of shares","shares","quantity","units","quantity transacted","transacted","amount"]){let r=t.findIndex(r=>r.toLowerCase().includes(e.toLowerCase()));if(-1!==r){o=r;break}}let d=-1;for(let e of["price / share","share price","price","rate","openrate","spot price","open rate"]){let r=t.findIndex(r=>r.toLowerCase().includes(e.toLowerCase()));if(-1!==r){d=r;break}}let c=-1===o?t.findIndex(e=>e.includes("shares")||e.includes("quantity")||e.includes("units")):o,u=-1===d?t.findIndex(e=>e.includes("price")||e.includes("rate")):d,p="Unknown";t.includes("units")&&t.includes("openrate")?p="eToro":t.includes("quantity transacted")&&t.includes("spot price at transaction")?p="Coinbase":t.includes("action")&&(t.includes("ticker")||t.includes("isin"))?p="Trading212":t.includes("t.price")&&t.includes("proceeds")?p="InteractiveBrokers":t.includes("stock")&&t.includes("total")?p="Freetrade":t.includes("side")&&t.includes("amount")?p="Webull":t.includes("quantity")&&t.includes("price")?p="Generic":t.includes("no. of shares")&&t.includes("price / share")&&(p="Trading212");let h=t.findIndex(e=>e.includes("currency")||e.includes("spot price currency"));for(let e=1;e<r.length;e++){let o=l(r[e]);if(!(o.length<t.length))try{let e=o[s]?.trim().toUpperCase()||"";if(!e||e.length>10||e.includes(" "))for(let r=0;r<o.length;r++){let t=o[r]?.trim().toUpperCase()||"";if(t&&t.length<=10&&!t.includes(" ")&&!["BUY","SELL","USD","EUR","GBP"].includes(t)&&/^[A-Z0-9]+$/.test(t)){e=t;break}}if(e.includes(" ")&&e.length>10){let r=e.split(" ");r.slice(1,-1).join(" ").trim(),e=r[r.length-1].trim()}let r=o[a]?.trim().toUpperCase()||"",t=parseFloat(o[c]?.trim()||"0"),l=parseFloat(o[u]?.trim().replace(/[$,\s]/g,"").replace(/X\d+$/,"")||"0"),d=h>=0&&o[h]?.trim().toUpperCase()||"USD";if(!e||r.includes("CASH")||r.includes("WITHDRAWAL")||r.includes("DIVIDEND"))continue;let p=r.toUpperCase(),m=p.includes("BUY")||p.includes("MARKET BUY")||p.includes("LIMIT BUY"),f=p.includes("SELL")||p.includes("MARKET SELL")||p.includes("LIMIT SELL");if(m||f){let r={id:`csv-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,date:o[i]?.trim()||new Date().toISOString().split("T")[0],ticker:e,type:m?"BUY":"SELL",currency:d,qty:t,price:l,mock:!1};r.ticker&&r.qty>0&&r.price>0&&n.push(r)}}catch(e){}}return{trades:n,broker:p}},u=async r=>{if((0,s.FK)({source:"dashboard_upload"}),!r.name.toLowerCase().endsWith(".csv")){alert("Please select a valid CSV file."),(0,s.cy)({errorType:"invalid_file_type",errorMessage:"File is not a CSV"});return}o(!0);try{let t=await r.text(),n=d(t);if(!n.valid){(0,s.cy)({errorType:"validation_failed",errorMessage:n.errors.join("; ")}),alert(`Invalid CSV format:

${n.errors.join("\n")}

Please ensure your CSV has the required columns:
• Date/Timestamp
• Ticker/Symbol
• Type/Action
• Quantity/Units
• Price/Rate`),o(!1);return}let{trades:i,broker:a}=c(t);if(0===i.length){(0,s.cy)({errorType:"no_trades_found",errorMessage:"No valid trades found in CSV",broker:a}),alert("No valid trades found in the CSV file. Please check that:\n• Your CSV contains BUY or SELL transactions\n• Quantity and price values are valid numbers\n• The file format matches the supported formats"),o(!1);return}e(i),(0,s.Qk)({broker:a,rowCount:i.length,fileSize:r.size}),alert(`✓ Successfully imported ${i.length} trade${1===i.length?"":"s"} from ${r.name}`)}catch(e){(0,s.cy)({errorType:"parse_error",errorMessage:e instanceof Error?e.message:"Unknown error"}),alert("Error processing CSV file. Please check the format and try again.\n\nError: "+(e instanceof Error?e.message:"Unknown error"))}finally{o(!1)}},p=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?t(!0):"dragleave"===e.type&&t(!1)};return(0,n.jsxs)("div",{onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:e=>{e.preventDefault(),e.stopPropagation(),t(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&u(e.dataTransfer.files[0])},style:{border:`2px dashed ${r?"var(--brand)":"var(--card-border)"}`,borderRadius:"12px",padding:"32px",textAlign:"center",background:r?"var(--chrome)":"var(--card)",transition:"all 0.2s ease",cursor:"pointer"},children:[n.jsx("input",{type:"file",accept:".csv",onChange:e=>{e.target.files&&e.target.files[0]&&u(e.target.files[0])},style:{display:"none"},id:"csv-upload",disabled:a}),n.jsx("label",{htmlFor:"csv-upload",style:{cursor:a?"not-allowed":"pointer"},children:a?(0,n.jsxs)("div",{children:[n.jsx("div",{className:"skeleton-loader",style:{height:"40px",borderRadius:"8px",marginBottom:"16px"}}),n.jsx("p",{style:{color:"var(--muted)",fontSize:"16px"},children:"Processing CSV file..."})]}):(0,n.jsxs)("div",{children:[n.jsx("div",{style:{width:"48px",height:"48px",background:"var(--brand)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",color:"white",fontSize:"24px"},children:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("path",{d:"M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M14 2V8H20",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M12 18L12 12",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.jsx("path",{d:"M9 15L12 12L15 15",stroke:"var(--accent-warm)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),n.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px",color:"var(--text)"},children:"Drop CSV file here or click to browse"}),n.jsx("p",{style:{color:"var(--muted)",fontSize:"14px",marginBottom:"16px"},children:"Supports multiple CSV formats: Trading212, eToro, Coinbase, OpenBrokerCSV, and more"}),(0,n.jsxs)("div",{style:{background:"var(--bg)",border:"1px solid var(--card-border)",borderRadius:"8px",padding:"16px",fontSize:"12px",color:"var(--muted)",textAlign:"left"},children:[n.jsx("strong",{children:"Supported formats:"}),n.jsx("br",{}),"• Trading212: Action, Time, Ticker, No. of shares, Price / share...",n.jsx("br",{}),"• eToro: PositionID, OrderID, Action, Ticker, Units, OpenRate...",n.jsx("br",{}),"• Coinbase: Timestamp, Transaction Type, Asset, Quantity, Spot Price...",n.jsx("br",{}),"• OpenBrokerCSV: Date, Ticker, Type, Currency, Quantity, Price",n.jsx("br",{}),n.jsx("br",{}),n.jsx("strong",{children:"Required columns:"})," Date, Ticker/Symbol, Type/Action, Quantity/Units, Price/Rate"]})]})})]})}}};